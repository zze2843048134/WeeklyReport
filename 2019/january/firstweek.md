## 2019-01-04 第一周周报  

**项目名：《我是球星》**  
**负责人：钟子恩**

> ### 本周工作内容
> 
>  * 星期三：
>  > 1.修复点球大战比分上点球数显示不全。
>  >> * 期望效果：可以全部显示。
>  >> * 完成情况：已完成。
>  >> * 问题原因：视图测量绘制时间节点和顺序错误导致。
>  >> * 解决方法：在视图显示出来的时候首先使用__递归方式__加载点球数量到布局，点球数加载完毕后再调整比分牌的内容和组件大小。
>  
>  > 2.修复进入点球大战后退出直播间，再进入直播间还未开始播放就显示点球记录按钮。
>  >> * 期望效果：再次进入时候点球记录按钮隐藏。
>  >> * 完成情况：已完成。 
>  >> * 问题原因：点球大战开始后默认显示记录按钮。
>  >> * 解决方法：取消默认显示。

> * 星期四：
> > 1.字幕输入框调居中显示。
> >> * 期望效果：顶部左对齐。
> >> * 完成情况：已完成。
> 
> > 2.修改字幕水印显示方位和走马灯范围，并防止字幕外溢。
> >> * 期望效果：显示在左下角，宽315dp，高22dp。
> >> * 完成情况：已完成。  
> >> * 问题原因：调整字幕像素时候使用了错误变量导致字符显示方位和走马灯范围错误；以及第三方控件自身问题造成字幕外溢。
> >> * 解决方法：首先使用一个布局包含字幕控件防止字幕外溢，并且字幕铺满父布局；然后使用字幕父布局的LayoutParams的宽高属性来调整字幕显示方位和走马灯范围。
> 
> > 3.直播界面镜头缩放卡顿。
> >> * 期望效果：镜头缩放流程。
> >> * 完成情况：未完成。
> >> * 问题原因：由于直播水印的刷新和绘制都在主线程中操作，而且只能在主线程中操作，而且刷新相对频繁，绘制水印也相对耗时，又由于通过调整SeekBar刻度来控制镜头缩放，同样是需要在主线程中操作，所以造成卡顿。
> >> * 解决方法：使用__触摸缩放__代替SeekBar。
> >> * 疑难定位：__相机缩放__需要手动计算出因子并控制相机的一组缩放系数，且相机经过第三方平台封装后有部分数据无法获得和部分方法无法调用，但可以获得最大可以缩放上限，公式导出ing。

> * 星期五：
> > 1.直播界面镜头缩放卡顿。
> >> * 期望效果：镜头缩放流程。
> >> * 完成情况：已完成。
> >> * 问题原因：同上，略。
> >> * 解决方法：由于通过第三方可以返回最大缩放上限，和设置缩放比例的方法，所以可以通过计算出缩放系数来控制缩放比例。触摸缩放系数公式__f(zoom)__推导如下：__f(scale) = scale + 当前两指距离 / 上一次两指距离 - 1__ ，f(scale)在闭区间[0，4]上，__f(zoom) = MaxZoom * f(scale) / 4__，f(zoom)在闭区间[0,MaxZoom]上。
>
> > 2.更换直播logo
> >> * 完成情况：已完成。
> 
> > 3.赛程页面和赛事详情报名列表代码整理和迭代。
> >> * 完成情况：已完成。

-------------------------------------------------------------------

> ### 工作的收获
> 
> 1. for循环中向父控件添加子控件，会由于前面操作还未来得及测量就添加下一子控件，从而导致父控件的宽高未来得及调整，使得子控件无法完全显示出来(比分牌显示点球数)
> 2. 控件在不可见状态下也就是 Activity 未展示给用户和控件在 Gone 状态下，控件不会触发测量布局绘制这个流程。(居然忘了这点)
> 3. 已经掌握 kotlin 基本语法，但不能说是熟练掌握

-------------------------------------------------------------------

> ### 工作中的不足
> 
> 1. 从工作中可以看出对 View 的掌握熟练，且有所遗忘。特别是 ViewGroup 的 addView 过程。
> 2. 对触摸手势组件的使用相对薄弱
> 3. 对 Camera 的相关知识尚未掌握
> 4. 处理问题的方式方法效率略低

-------------------------------------------------------------------

> ### 下周工作计划
> 
> 1. 页面迭代成沉浸式
> 2. 列表滑动流畅度优化
> 3. 通知权限优化
> 4. 通过图片缩放平移研究触摸手势组件

